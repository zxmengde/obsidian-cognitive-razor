# 发布检查清单

在创建新版本发布之前，请确保完成以下所有检查项。

## 代码质量检查

- [ ] 所有单元测试通过（`npm test`）
- [ ] 所有属性测试通过
- [ ] 所有集成测试通过
- [ ] 代码通过 ESLint 检查（`npm run lint`）
- [ ] TypeScript 编译无错误（`tsc -noEmit`）
- [ ] 没有 console.log 或调试代码残留

## 构建检查

- [ ] 生产构建成功（`npm run build`）
- [ ] `main.js` 文件已生成
- [ ] `main.js` 文件大小合理（< 500KB）
- [ ] `styles.css` 文件存在且正确
- [ ] 插件在 Obsidian 中可以正常加载

## 版本信息检查

- [ ] `manifest.json` 中的版本号已更新
- [ ] `package.json` 中的版本号已更新
- [ ] `versions.json` 已添加新版本映射
- [ ] `manifest.json` 中的 `minAppVersion` 正确
- [ ] `manifest.json` 中的描述准确
- [ ] `manifest.json` 中的作者信息完整

## 文档检查

- [ ] `README.md` 已更新（如有新功能）
- [ ] `CHANGELOG.md` 已添加新版本条目
- [ ] 所有新功能都有文档说明
- [ ] 文档中的版本号已更新
- [ ] 文档中的链接都有效
- [ ] 截图和示例已更新（如需要）

## 功能测试

### 核心功能
- [ ] 概念创建功能正常
- [ ] 标准化处理正确
- [ ] 类型判断准确
- [ ] 别名生成合理

### 去重检测
- [ ] 相似度检索正常
- [ ] 重复对显示正确
- [ ] 阈值设置生效
- [ ] 合并功能正常

### AI 内容生成
- [ ] Issue 类型内容正确
- [ ] Theory 类型内容正确
- [ ] Mechanism 类型内容正确
- [ ] Entity 类型内容正确
- [ ] Domain 类型内容正确
- [ ] 内容预览正常

### 增量改进
- [ ] 意图输入正常
- [ ] 差异预览正确
- [ ] 确认写入成功
- [ ] 状态降级正确

### 可逆写入
- [ ] 快照创建成功
- [ ] 撤销功能正常
- [ ] 操作历史显示正确
- [ ] 快照清理正常

### 任务队列
- [ ] 任务入队成功
- [ ] 任务执行正常
- [ ] 任务取消有效
- [ ] 任务重试正常
- [ ] 暂停/恢复功能正常
- [ ] 锁机制正确

### UI 组件
- [ ] WorkbenchPanel 显示正常
- [ ] QueueView 功能正常
- [ ] DiffView 显示正确
- [ ] StatusBadge 更新及时
- [ ] 快捷键都有效

### Provider 配置
- [ ] Google Gemini 配置正常
- [ ] OpenAI 配置正常
- [ ] OpenRouter 配置正常
- [ ] API Key 验证有效
- [ ] Provider 切换正常

### 错误处理
- [ ] 网络错误处理正确
- [ ] API 错误处理正确
- [ ] 验证错误提示清晰
- [ ] 重试机制正常
- [ ] 错误日志记录完整

## 兼容性测试

- [ ] 在 Windows 上测试通过
- [ ] 在 macOS 上测试通过
- [ ] 在 Linux 上测试通过
- [ ] 在 Obsidian 桌面版测试通过
- [ ] 在 Obsidian 移动版测试通过（如支持）
- [ ] 与其他常用插件兼容

## 性能测试

- [ ] 插件启动时间 ≤ 2 秒
- [ ] 持久化延迟 ≤ 200ms
- [ ] UI 刷新延迟 ≤ 100ms
- [ ] 向量检索延迟 ≤ 500ms（1000 条索引）
- [ ] 内存使用合理
- [ ] 没有内存泄漏

## 安全检查

- [ ] 没有硬编码的敏感信息
- [ ] API Key 安全存储
- [ ] 日志不包含敏感信息
- [ ] 不执行远程代码
- [ ] 不访问 vault 外的文件
- [ ] 网络请求都有明确目的

## 发布准备

- [ ] Git 工作区干净（无未提交的更改）
- [ ] 所有更改已提交到 main 分支
- [ ] 创建了版本标签（格式：`1.0.0`，无 `v` 前缀）
- [ ] 标签已推送到远程仓库
- [ ] Release 说明已准备好
- [ ] 发布文件已准备好：
  - [ ] `main.js`
  - [ ] `manifest.json`
  - [ ] `styles.css`

## GitHub Release

- [ ] 在 GitHub 上创建了 Release
- [ ] Release 标题格式正确（如：`Cognitive Razor 1.0.0`）
- [ ] Release 说明完整且清晰
- [ ] 附件文件已上传（main.js, manifest.json, styles.css）
- [ ] Release 已发布（不是草稿）

## 发布后验证

- [ ] Release 页面可以正常访问
- [ ] 附件文件可以正常下载
- [ ] 手动安装测试成功
- [ ] 在新的 vault 中测试成功
- [ ] 从旧版本升级测试成功（如适用）

## 社区插件市场（首次发布）

如果是首次发布，还需要：

- [ ] Fork obsidian-releases 仓库
- [ ] 在 community-plugins.json 中添加插件信息
- [ ] 创建 Pull Request
- [ ] PR 描述清晰完整
- [ ] 等待 Obsidian 团队审核

## 通知和宣传

- [ ] 在 GitHub Discussions 发布公告
- [ ] 更新项目主页（如有）
- [ ] 在社交媒体分享（可选）
- [ ] 通知测试用户（可选）

## 回滚计划

如果发现严重问题：

- [ ] 知道如何删除 Release
- [ ] 知道如何删除 Git 标签
- [ ] 有回滚到上一版本的计划
- [ ] 有通知用户的渠道

---

## 检查清单使用说明

1. **发布前**：逐项检查，确保所有项目都完成
2. **发布中**：按照 RELEASE.md 中的步骤操作
3. **发布后**：验证发布是否成功
4. **问题处理**：如发现问题，立即回滚并修复

## 版本类型

### 补丁版本（1.0.x）
- 主要关注：bug 修复、性能优化
- 可以跳过：部分兼容性测试、文档更新

### 次要版本（1.x.0）
- 主要关注：新功能、文档更新
- 必须完成：所有测试、完整文档

### 主要版本（x.0.0）
- 主要关注：重大变更、向后兼容性
- 必须完成：所有检查项、迁移指南

---

**最后提醒**：发布是一个严肃的过程，请认真对待每一个检查项。宁可多花时间检查，也不要匆忙发布有问题的版本。
