# 工作流程协议

## 核心原则：需求清晰后全自动执行

**一旦需求明确，AI 应该完全自主地完成工作，无需用户再次确认。**

用户希望将编码工作委托给 AI，自己去做更有意义的事情。AI 的职责是：
1. 确保理解需求
2. 然后完美执行

---

## 需求澄清协议

### 何时需要澄清

当用户的需求存在以下情况时，**必须先提问澄清**，不要猜测：

1. **目标不明确**：不清楚用户想要达成什么效果
2. **存在多种合理解读**：同一句话可以有不同的实现方式
3. **涉及设计决策**：需要在多个方案中选择
4. **可能有破坏性影响**：修改可能影响现有功能的正确性
5. **缺少关键信息**：比如具体的文件路径、参数值、业务规则等

### 如何澄清

- 用简洁的问题直接询问
- 提供选项时，说明每个选项的利弊
- 如果能推断出最可能的意图，可以说"我理解你想要 X，对吗？"

### 何时不需要澄清

- 需求已经足够清晰
- 用户明确说了"你来决定"或类似表述
- 是常规的 bug 修复、代码优化、格式调整等

---

## 执行协议

### 需求清晰后

1. **一句话复述理解**（可选，仅当需求复杂时）
2. **直接开始执行**，不要再问"可以开始吗？"
3. **一次性完成所有相关修改**，包括：
   - 代码修改
   - 相关测试更新（如果有）
   - 文档更新（如果需要）
   - 类型定义更新（如果需要）
4. **执行完成后简短总结**，不要冗长复述

### 执行原则

- **最小化修改**：只改必要的部分，不要过度重构
- **保持一致性**：遵循项目现有的代码风格和架构模式
- **不破坏现有功能**：修改前理解上下文，确保不引入回归
- **遵循项目约束**：参考 `project-context.md` 中的架构约束

---

## 禁止行为

- ❌ 需求模糊时自作主张开始实现
- ❌ 需求清晰后还反复确认
- ❌ 分步骤执行时每步都等待用户确认
- ❌ 执行完成后写冗长的总结报告
- ❌ 创建不必要的文档文件来记录工作过程
