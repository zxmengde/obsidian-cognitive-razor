# Cognitive Razor 常见问题解答 (FAQ)

## 📦 安装和配置

### Q1: 支持哪些 Obsidian 版本？

**A:** Cognitive Razor 需要 Obsidian 1.0.0 或更高版本。建议使用最新版本以获得最佳体验。

### Q2: 支持移动端吗？

**A:** 目前仅支持桌面端（Windows、macOS、Linux）。移动端支持正在开发中。

### Q3: 如何获取 API Key？

**A:** 根据你选择的 Provider：

- **Google Gemini**: 访问 [Google AI Studio](https://makersuite.google.com/app/apikey)
- **OpenAI**: 访问 [OpenAI Platform](https://platform.openai.com/api-keys)
- **OpenRouter**: 访问 [OpenRouter](https://openrouter.ai/keys)（使用 OpenAI Provider + 自定义端点）

注册账号后即可创建 API Key。

### Q4: API Key 安全吗？

**A:** 是的。API Key 使用 Obsidian 的安全存储机制加密保存在本地，不会被上传到任何服务器。

### Q5: 可以使用多个 Provider 吗？

**A:** 可以配置多个 Provider，但同一时间只能使用一个作为默认 Provider。你可以在设置中添加多个 Provider 并切换默认选项。

### Q5.1: 支持哪些 Provider？

**A:** 从 v2.0.0 开始，插件支持：

- **Google Gemini**：官方 Gemini API
- **OpenAI**：官方 OpenAI API

通过自定义端点功能，你还可以使用：

- **OpenRouter**：设置 OpenAI Provider 的自定义端点为 `https://openrouter.ai/api/v1`
- **本地模型**：如 Ollama、LM Studio 等
- **其他兼容服务**：任何实现了 OpenAI 或 Gemini API 接口的服务

### Q5.2: 如何配置自定义端点？

**A:** 

1. 打开设置 → Cognitive Razor → Provider 配置
2. 添加或编辑 Provider
3. 在"自定义端点"字段中输入 URL
4. 留空则使用默认端点

**URL 要求**：
- 必须以 `http://` 或 `https://` 开头
- 必须是有效的 URL 格式
- 建议使用 HTTPS 以确保安全性

### Q6: 忘记了 API Key 怎么办？

**A:** 你需要重新生成 API Key：

1. 访问对应 Provider 的控制台
2. 撤销旧的 API Key
3. 创建新的 API Key
4. 在插件设置中更新

### Q6.1: 从旧版本升级后，OpenRouter 配置不见了？

**A:** 从 v2.0.0 开始，OpenRouter 不再作为独立 Provider。请查看[配置迁移指南](配置迁移指南.md)了解如何迁移配置。

简要步骤：
1. 选择 OpenAI Provider
2. 输入 OpenRouter API Key
3. 设置自定义端点为 `https://openrouter.ai/api/v1`
4. 选择 OpenRouter 支持的模型

## 🎯 概念创建

### Q7: 什么是知识类型？

**A:** Cognitive Razor 支持五种知识类型：

- **Domain（领域）**: 知识领域的边界和结构
- **Issue（议题）**: 核心张力或矛盾（X vs Y）
- **Theory（理论）**: 基于公理的理论框架
- **Entity（实体）**: 具体的事物或概念
- **Mechanism（机制）**: 因果链和作用机制

### Q8: 如何选择正确的知识类型？

**A:** 系统会自动判断并给出置信度分数。如果最高置信度 < 0.6，建议手动选择：

- 描述一个领域 → Domain
- 描述一个矛盾或权衡 → Issue
- 描述一个理论体系 → Theory
- 描述一个具体事物 → Entity
- 描述一个运作机制 → Mechanism

### Q9: 可以修改自动生成的标准名称吗？

**A:** 可以。在确认创建前，你可以手动编辑标准名称和别名。

### Q10: 别名有什么用？

**A:** 别名用于：

1. 提高搜索准确性
2. 支持多种表达方式
3. 关联相关概念
4. 改善语义去重效果

### Q11: 为什么有时候类型判断不准确？

**A:** 可能的原因：

- 概念描述过于简短或模糊
- 概念本身具有多重属性
- AI 模型的局限性

建议：提供更详细的描述，或手动选择类型。

## 🔍 语义去重

### Q12: 什么是语义去重？

**A:** 语义去重通过向量相似度检测概念的语义重复，而不仅仅是文本匹配。例如 "机器学习" 和 "ML" 会被识别为相似概念。

### Q13: 去重阈值如何设置？

**A:** 默认阈值是 0.9（90% 相似度）。你可以在设置中调整：

- **提高阈值（0.95+）**: 只检测非常相似的概念，减少误报
- **降低阈值（0.85-）**: 检测更多潜在重复，可能增加误报

### Q14: 为什么有些明显重复的概念没有被检测到？

**A:** 可能的原因：

1. **类型不同**: 系统只在同类型概念中检测重复
2. **阈值过高**: 尝试降低去重阈值
3. **向量索引未更新**: 重启插件或手动刷新索引

### Q15: 可以跨类型检测重复吗？

**A:** 不可以。这是设计决策，因为不同类型的概念即使名称相似，其性质也可能完全不同。

### Q16: 合并概念后可以撤销吗？

**A:** 可以。合并操作会创建快照，你可以在 5 秒内快速撤销，或稍后从操作历史中撤销。

### Q17: 合并时如何选择保留哪个笔记？

**A:** 系统会将合并内容写入第一个笔记（通常是较早创建的），并删除第二个笔记。合并前会在预览中明确显示。

## 🤖 AI 内容生成

### Q18: 生成的内容准确吗？

**A:** AI 生成的内容是基于训练数据的推理结果，可能存在错误或不准确。建议：

1. 仔细审查生成的内容
2. 根据需要进行修改
3. 使用增量改进功能逐步完善

### Q19: 可以自定义生成内容的格式吗？

**A:** 可以。高级用户可以修改 `prompts/` 目录下的提示词模板。修改后需要重启插件。

### Q20: 生成内容失败怎么办？

**A:** 系统会自动重试 3 次。如果仍然失败：

1. 检查 API Key 是否有效
2. 检查网络连接
3. 查看日志文件（`data/logs/`）了解详细错误
4. 尝试更换 Provider

### Q21: 为什么生成内容很慢？

**A:** 可能的原因：

- **网络延迟**: 检查网络连接
- **API 限流**: 等待一段时间后重试
- **模型响应慢**: 尝试更换更快的模型
- **队列拥堵**: 等待前面的任务完成

### Q22: 可以批量生成内容吗？

**A:** 可以。创建多个 Stub 笔记后，系统会自动将生成任务加入队列，按顺序执行。

## 📝 增量改进

### Q23: 什么是增量改进？

**A:** 增量改进允许你对现有笔记进行渐进式完善，而不是一次性重写整篇笔记。

### Q24: Evergreen 笔记为什么会降级？

**A:** 这是设计决策。Evergreen 表示内容已经成熟稳定，任何修改都应该重新审查。降级为 Draft 提醒你重新评估内容质量。

### Q25: 可以阻止状态降级吗？

**A:** 不可以。这是核心设计原则，确保内容质量的可追溯性。

### Q26: 改进意图应该如何描述？

**A:** 提供清晰、具体的指令，例如：

✅ **好的示例**:
- "添加 3 个实际应用案例"
- "补充数学公式和推导过程"
- "扩展历史背景部分"

❌ **不好的示例**:
- "改进一下"（太模糊）
- "让它更好"（不具体）

## ↩️ 撤销和快照

### Q27: 所有操作都可以撤销吗？

**A:** 是的。所有写入操作（创建、改进、合并）都会创建快照，可以撤销。

### Q28: 快照会占用很多空间吗？

**A:** 快照只保存文本内容，占用空间很小。系统默认保留 100 个快照，超过会自动清理最旧的。

### Q29: 可以手动清理快照吗？

**A:** 可以。在设置中点击 "清理快照" 按钮，或手动删除 `data/snapshots/` 目录下的文件。

### Q30: 撤销后可以重做吗？

**A:** 不可以。撤销操作会删除快照，无法重做。请谨慎使用撤销功能。

## 📋 任务队列

### Q31: 为什么任务会排队？

**A:** 为了防止：

1. **锁冲突**: 同一概念不能同时被多个任务修改
2. **API 限流**: 避免超过 API 速率限制
3. **资源管理**: 控制并发数量，保持系统稳定

### Q32: 可以调整并发任务数吗？

**A:** 可以。在设置中调整 "并发任务数"（1-5）。注意：过高的并发可能导致 API 限流。

### Q33: 任务失败后会自动重试吗？

**A:** 是的。系统会自动重试 3 次，使用指数退避策略。如果 3 次都失败，任务会被标记为失败。

### Q34: 可以取消正在执行的任务吗？

**A:** 可以，但可能无法立即停止。系统会在当前 API 调用完成后取消任务。

### Q35: 任务历史会保留多久？

**A:** 已完成和失败的任务会保留在队列状态中，直到你手动清理或重启插件。

## 🔒 数据和隐私

### Q36: 数据存储在哪里？

**A:** 所有数据存储在本地：

```
<vault>/.obsidian/plugins/obsidian-cognitive-razor/data/
├── settings.json          # 插件配置
├── vector-index.json      # 向量索引
├── queue-state.json       # 任务队列
├── duplicate-pairs.json   # 重复对
├── snapshots/             # 快照
└── logs/                  # 日志
```

### Q37: 哪些数据会发送给 AI API？

**A:** 只有以下数据会发送：

1. 你输入的概念描述
2. 笔记的标题和内容（仅在生成内容或改进时）
3. 提示词模板

**不会发送**：
- 其他笔记内容
- Vault 结构
- 个人信息
- 向量索引

### Q38: 可以离线使用吗？

**A:** 不可以。插件需要调用 AI API 进行推理。但所有数据存储和检索都在本地完成。

### Q39: 如何备份数据？

**A:** 备份整个 `data/` 目录即可：

```bash
cp -r <vault>/.obsidian/plugins/obsidian-cognitive-razor/data/ <backup-location>/
```

### Q40: 如何迁移到新的 Vault？

**A:** 

1. 在新 Vault 中安装插件
2. 复制旧 Vault 的 `data/` 目录到新 Vault
3. 重启 Obsidian

## ⚙️ 性能和优化

### Q41: 插件会影响 Obsidian 性能吗？

**A:** 正常使用下影响很小。插件采用异步设计，不会阻塞主线程。

### Q42: 向量索引会很大吗？

**A:** 取决于概念数量。每个概念约占 1-2 KB。1000 个概念约 1-2 MB。

### Q43: 如何优化性能？

**A:** 

1. 降低并发任务数
2. 定期清理快照
3. 使用更快的 Provider 和模型
4. 关闭不必要的日志记录

### Q44: 日志文件会无限增长吗？

**A:** 不会。日志采用循环机制，单个日志文件最大 1 MB，超过会自动轮转。

## 🔧 故障排除

### Q45: 插件无法加载怎么办？

**A:** 

1. 检查 Obsidian 版本是否 ≥ 1.0.0
2. 检查插件文件是否完整（`main.js`, `manifest.json`, `styles.css`）
3. 查看 Obsidian 控制台（`Ctrl/Cmd + Shift + I`）的错误信息
4. 尝试重新安装插件

### Q46: API 调用失败怎么办？

**A:** 

1. 检查 API Key 是否有效
2. 检查网络连接
3. 检查是否超过 API 配额
4. 如果使用自定义端点，检查 URL 是否正确
5. 查看日志文件了解详细错误

### Q46.1: 自定义端点无法连接？

**A:** 

1. 确认端点 URL 格式正确（必须以 `http://` 或 `https://` 开头）
2. 确认服务已启动并可访问
3. 检查防火墙设置
4. 如果是本地服务，确认端口号正确
5. 尝试在浏览器中访问端点 URL 测试连通性

### Q47: 向量索引损坏怎么办？

**A:** 

1. 备份 `vector-index.json`
2. 删除该文件
3. 重启插件
4. 系统会自动重建索引

### Q48: 如何查看日志？

**A:** 日志文件位于 `data/logs/` 目录。使用文本编辑器打开查看。

### Q49: 如何报告 Bug？

**A:** 

1. 访问 [GitHub Issues](https://github.com/your-username/obsidian-cognitive-razor/issues)
2. 搜索是否已有相同问题
3. 创建新 Issue，包含：
   - 问题描述
   - 复现步骤
   - 错误信息
   - 日志文件（如适用）

### Q50: 如何获取帮助？

**A:** 

- 📖 阅读 [快速开始指南](快速开始指南.md)
- 🔄 查看 [配置迁移指南](配置迁移指南.md)
- 🔧 查看 [故障排除指南](故障排除指南.md)
- 💬 访问 [讨论区](https://github.com/your-username/obsidian-cognitive-razor/discussions)
- 🐛 报告 [Bug](https://github.com/your-username/obsidian-cognitive-razor/issues)

---

**还有其他问题？** 欢迎在 [讨论区](https://github.com/your-username/obsidian-cognitive-razor/discussions) 提问！
