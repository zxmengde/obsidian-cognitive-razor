# Cognitive Razor 快速开始指南

欢迎使用 Cognitive Razor！本指南将帮助你在 5 分钟内开始使用插件。

## 📋 前置要求

- Obsidian 版本 1.0.0 或更高
- 有效的 AI API Key（Google Gemini / OpenAI / OpenRouter）

## 🚀 第一步：安装和配置

### 1. 安装插件

**方式一：从社区插件安装（推荐）**

1. 打开 Obsidian 设置（`Ctrl/Cmd + ,`）
2. 进入 **社区插件** → 关闭安全模式
3. 点击 **浏览** 搜索 "Cognitive Razor"
4. 点击 **安装** → **启用**

**方式二：手动安装**

1. 从 [Releases](https://github.com/your-username/obsidian-cognitive-razor/releases) 下载最新版本
2. 解压到 `<vault>/.obsidian/plugins/obsidian-cognitive-razor/`
3. 重启 Obsidian 并启用插件

### 2. 配置 AI Provider

首次启用插件时会自动打开配置向导：

#### 选项 A：使用 Google Gemini（推荐新手）

1. 访问 [Google AI Studio](https://makersuite.google.com/app/apikey)
2. 登录 Google 账号
3. 点击 **Create API Key**
4. 复制 API Key
5. 在配置向导中选择 **Google Gemini**
6. 粘贴 API Key 并点击 **验证**
7. （可选）配置自定义端点

#### 选项 B：使用 OpenAI

1. 访问 [OpenAI Platform](https://platform.openai.com/api-keys)
2. 登录并创建 API Key
3. 在配置向导中选择 **OpenAI**
4. 粘贴 API Key 并选择模型（推荐 gpt-4-turbo-preview）
5. （可选）配置自定义端点

#### 选项 C：使用 OpenRouter（通过自定义端点）

1. 访问 [OpenRouter](https://openrouter.ai/keys)
2. 注册并创建 API Key
3. 在配置向导中选择 **OpenAI**
4. 粘贴 OpenRouter API Key
5. 在"自定义端点"字段中输入：`https://openrouter.ai/api/v1`
6. 选择 OpenRouter 支持的模型

> **提示**：从 v2.0.0 开始，OpenRouter 不再作为独立 Provider。使用 OpenAI Provider + 自定义端点即可访问 OpenRouter 服务。

#### 选项 D：使用本地模型

1. 确保本地模型服务已启动（如 Ollama、LM Studio）
2. 在配置向导中选择 **OpenAI**
3. 输入任意 API Key（本地服务通常不需要）
4. 在"自定义端点"字段中输入本地服务地址（如 `http://localhost:8080/v1`）
5. 选择本地模型名称

### 3. 验证配置

配置完成后，系统会自动验证 API Key：

- ✅ **验证成功**：显示绿色勾号，可以开始使用
- ❌ **验证失败**：检查 API Key 是否正确，网络是否正常

## 🎯 第二步：创建第一个概念

### 方式一：使用快捷键（推荐）

1. 按 `Ctrl/Cmd + Shift + N`
2. 在输入框中描述概念，例如：
   ```
   机器学习中的过拟合问题
   ```
3. 点击 **标准化**

### 方式二：使用侧边栏

1. 点击左侧边栏的 Cognitive Razor 图标
2. 在 "创建概念" 区域输入描述
3. 点击 **标准化**

### 理解标准化结果

系统会返回：

```yaml
中文名称: 过拟合
英文名称: Overfitting
别名:
  - 过度拟合
  - 模型过拟合
  - 训练过度
  - 过度学习
  - Overtraining
类型置信度:
  - Issue: 0.85 ⭐ (最高)
  - Theory: 0.08
  - Mechanism: 0.05
  - Entity: 0.01
  - Domain: 0.01
```

### 确认创建

1. 检查标准化结果是否准确
2. 如果类型置信度最高值 < 0.6，需要手动选择类型
3. 点击 **确认创建**

### 生成内容

系统会根据类型生成结构化内容：

**Issue 类型示例**：
```markdown
---
uid: 550e8400-e29b-41d4-a716-446655440000
type: Issue
status: Stub
created: 2024-01-01T00:00:00Z
updated: 2024-01-01T00:00:00Z
aliases: [过度拟合, 模型过拟合, Overtraining]
---

# 过拟合 (Overfitting)

## 核心张力
泛化能力 vs 训练准确率

## 定义
...
```

### 预览和确认

1. 在差异视图中预览生成的内容
2. 检查内容是否符合预期
3. 点击 **确认写入**
4. 笔记创建完成！

## 🔍 第三步：处理重复概念

### 自动检测

创建概念后，系统会自动：

1. 在同类型概念中搜索相似概念
2. 如果相似度 ≥ 0.9，标记为重复
3. 在侧边栏显示重复对

### 查看重复对

1. 打开侧边栏的 "重复概念" 面板
2. 查看重复对列表：
   ```
   📄 过拟合 ↔️ 过度拟合
   相似度: 95%
   类型: Issue
   ```

### 处理重复

**选项 1：合并概念**

1. 点击 **合并**
2. AI 会读取两篇笔记并生成合并后的内容
3. 在差异视图中预览
4. 确认后：
   - 合并内容写入主笔记
   - 删除被合并笔记
   - 更新向量索引

**选项 2：忽略**

1. 点击 **忽略**
2. 标记为非重复
3. 从列表中移除

**选项 3：稍后处理**

- 保留在列表中，稍后再处理

## 📝 第四步：增量改进笔记

### 触发改进

1. 打开要改进的笔记
2. 右键点击笔记标题
3. 选择 **增量改进**

### 输入改进意图

在弹出的输入框中描述改进意图，例如：

```
添加 3 个实际案例
```

或

```
补充理论依据和数学公式
```

### 预览和确认

1. AI 生成改进后的内容
2. 在差异视图中查看变更：
   - 🟢 绿色：新增内容
   - 🔴 红色：删除内容
   - 🟡 黄色：修改内容
3. 确认后写入

### 状态变更

- 如果笔记状态是 **Evergreen**，改进后会降级为 **Draft**
- 这是为了提醒你重新审查内容

## ↩️ 第五步：撤销操作

### 快速撤销（5 秒内）

1. 写入完成后会显示通知
2. 点击通知中的 **撤销** 按钮
3. 内容立即恢复

### 查看操作历史

1. 打开侧边栏的 "最近操作" 面板
2. 查看所有可撤销的操作
3. 选择要撤销的操作
4. 点击 **撤销**

### 快照管理

- 系统自动保留最近 100 个快照
- 超过上限会自动清理最旧的快照
- 快照存储在 `data/snapshots/` 目录

## 📋 第六步：管理任务队列

### 打开队列视图

- 快捷键：`Ctrl/Cmd + Shift + Q`
- 或点击状态栏的任务计数

### 查看任务状态

任务分为四种状态：

- 🔄 **进行中**：正在执行的任务
- ⏳ **等待中**：排队等待的任务
- ✅ **已完成**：成功完成的任务
- ❌ **失败**：执行失败的任务

### 管理任务

**暂停队列**
1. 点击 **暂停** 按钮
2. 当前任务继续执行，新任务不会开始
3. 点击 **恢复** 继续执行

**取消任务**
1. 选择要取消的任务
2. 点击 **取消**
3. 任务状态变为 Cancelled，释放锁

**重试失败任务**
1. 选择失败的任务
2. 点击 **重试**
3. 任务重新加入队列

## 🎓 进阶技巧

### 1. 配置自定义端点

使用第三方服务或本地模型：

1. 打开设置 → Cognitive Razor → Provider 配置
2. 添加或编辑 Provider
3. 在"自定义端点"字段中输入 URL
4. 常用端点：
   - OpenRouter: `https://openrouter.ai/api/v1`
   - 本地 Ollama: `http://localhost:11434/v1`
   - 本地 LM Studio: `http://localhost:1234/v1`

### 2. 调整去重阈值

如果重复检测太敏感或不够敏感：

1. 打开设置 → Cognitive Razor
2. 调整 **去重阈值**（0.0 - 1.0）
3. 默认 0.9，降低会检测更多重复

### 3. 批量创建概念

1. 准备概念列表
2. 逐个输入并标准化
3. 系统会自动检测重复
4. 批量处理重复对

### 4. 自定义提示词

高级用户可以修改提示词模板：

1. 打开 `prompts/` 目录
2. 编辑对应的 `.md` 文件
3. 重启插件生效

### 5. 导出配置

备份或分享配置：

1. 打开设置 → Cognitive Razor
2. 点击 **导出配置**
3. 保存 JSON 文件
4. 在其他 vault 中导入

## ❓ 常见问题

### Q: 为什么需要 API Key？

A: Cognitive Razor 使用 AI 进行概念标准化、内容生成和语义分析。所有数据存储在本地，API 仅用于推理计算。

### Q: 数据会被上传到云端吗？

A: 不会。所有数据（笔记、向量索引、快照）都存储在本地。只有你明确输入的概念描述会发送给 AI API。

### Q: 如何更换 Provider？

A: 打开设置 → Cognitive Razor → Provider 配置，选择新的 Provider 并输入 API Key。

### Q: 如何使用 OpenRouter？

A: 从 v2.0.0 开始，选择 OpenAI Provider 并设置自定义端点为 `https://openrouter.ai/api/v1`。详见[配置迁移指南](配置迁移指南.md)。

### Q: 如何使用本地模型？

A: 选择 OpenAI Provider，设置自定义端点为本地服务地址（如 `http://localhost:11434/v1`），并输入本地模型名称。

### Q: 任务失败怎么办？

A: 系统会自动重试 3 次。如果仍然失败，检查：
- API Key 是否有效
- 网络是否正常
- 自定义端点 URL 是否正确
- 查看日志文件了解详细错误

## 🎉 下一步

恭喜！你已经掌握了 Cognitive Razor 的基本用法。

继续探索：

- 📖 阅读 [常见问题解答](常见问题解答.md)
- 🔄 查看 [配置迁移指南](配置迁移指南.md)（如果从旧版本升级）
- 🔧 查看 [故障排除指南](故障排除指南.md)
- 💬 加入 [讨论区](https://github.com/your-username/obsidian-cognitive-razor/discussions)

祝你使用愉快！🚀
