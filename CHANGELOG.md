# 更新日志

本文档记录 Cognitive Razor 插件的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划中
- 支持更多 AI Provider（Anthropic Claude、本地模型等）
- 批量处理重复概念
- 概念关系图可视化
- 导出知识图谱
- 多语言支持（英文、日文等）

## [1.0.0] - 2025-12-06

### 首次发布 🎉

这是 Cognitive Razor 的首个正式版本，实现了完整的公理化知识管理功能。

### 新增功能

#### 核心功能
- **概念标准化**：将模糊概念转化为结构化知识节点
  - AI 自动生成中英文标准名称
  - 生成 3-10 个别名
  - 智能判断知识类型（Domain、Issue、Theory、Entity、Mechanism）
  - 自动生成包含元数据的 Stub 笔记

- **语义去重检测**：自动检测和管理重复概念
  - 同类型概念的语义相似度检索
  - 可配置的相似度阈值（默认 0.9）
  - 侧边栏显示待处理的重复对
  - 支持查看相似度和概念详情

- **AI 内容生成**：根据知识类型生成结构化内容
  - Issue 类型：核心张力分析（X vs Y）
  - Theory 类型：公理化理论框架
  - Mechanism 类型：因果链机制描述
  - Entity 类型：属加种差定义
  - Domain 类型：领域边界划分
  - 内容预览和确认机制

- **增量改进**：对现有笔记进行渐进式完善
  - 意图输入框
  - AI 辅助的内容改进
  - 可视化差异预览
  - 状态自动降级（Evergreen → Draft）

- **可逆写入**：所有操作都可撤销
  - 自动创建文件快照
  - 5 秒内一键撤销
  - 操作历史查看
  - 自动清理旧快照（默认保留 100 个）

- **任务队列管理**：可视化管理 AI 任务
  - 任务状态显示（进行中、等待中、已完成、失败）
  - 支持暂停、取消和重试
  - 智能锁机制防止冲突
  - 状态栏实时显示任务进度

#### 数据管理
- **本地优先存储**：所有数据存储在本地
  - 向量索引本地化
  - 配置文件本地存储
  - 快照文件本地管理
  - 日志文件本地记录

- **配置管理**：灵活的配置系统
  - 支持多个 AI Provider
  - 配置导入导出
  - 配置验证
  - 版本迁移支持

#### AI Provider 支持
- **Google Gemini**：支持 Gemini Pro 模型
- **OpenAI**：支持 GPT-4 和 GPT-3.5-turbo
- **OpenRouter**：支持多种模型

#### 用户界面
- **WorkbenchPanel**：统一工作台
  - 创建概念区域
  - 重复概念面板
  - 队列状态区域
  - 最近操作区域

- **QueueView**：任务队列详情视图
  - 任务列表显示
  - 任务操作（取消、重试）
  - 并发控制

- **DiffView**：内容差异预览视图
  - 差异高亮显示
  - 逐项确认
  - 接受/放弃操作

- **StatusBadge**：状态栏徽章
  - 任务计数显示
  - 快捷入口

- **快捷键支持**：
  - `Ctrl/Cmd + Shift + N`：创建概念
  - `Ctrl/Cmd + Shift + Q`：打开队列视图
  - Tab 键焦点导航
  - Enter 键触发操作

#### 错误处理
- **智能重试机制**：
  - 结构化重试（最多 3 次）
  - 指数退避重试
  - 错误码映射
  - 详细错误日志

- **业务规则校验**：
  - Issue 类型格式约束
  - Theory 类型最小约束
  - Mechanism 类型最小约束
  - 其他业务规则（C001-C009）

#### 测试
- **单元测试**：覆盖核心功能
- **属性测试**：使用 fast-check 进行属性测试（每个测试 100 次迭代）
- **集成测试**：端到端流程测试
- **测试覆盖率**：高覆盖率保证代码质量

#### 文档
- **用户文档**：
  - 快速开始指南
  - 常见问题解答
  - 故障排除指南
  - 公理化设计文档

- **开发文档**：
  - README.md
  - AGENTS.md
  - RELEASE.md
  - CHANGELOG.md

### 技术栈
- TypeScript 4.7.4
- Obsidian API
- esbuild（构建工具）
- Jest（测试框架）
- fast-check（属性测试）

### 性能指标
- 持久化延迟：≤ 200ms
- UI 刷新延迟：≤ 100ms
- 向量检索延迟：≤ 500ms（1000 条索引）
- 插件启动时间：≤ 2s

### 安全与隐私
- 本地优先：所有数据存储在本地
- 最小化外发：仅发送用户明确输入的概念信息
- API Key 加密：使用 Obsidian 安全存储
- 日志脱敏：不记录敏感信息
- 安全边界：提示词包含安全约束

### 已知限制
- 需要有效的 AI API Key
- 向量嵌入依赖 AI Provider
- 大型 vault 可能需要较长的初始索引时间

### 致谢
感谢所有测试用户和贡献者的支持！

---

## 版本说明

### 版本号格式
- **主版本号（Major）**：重大变更，可能不向后兼容
- **次版本号（Minor）**：新功能，向后兼容
- **修订号（Patch）**：bug 修复，向后兼容

### 变更类型
- **新增（Added）**：新功能
- **变更（Changed）**：现有功能的变更
- **弃用（Deprecated）**：即将移除的功能
- **移除（Removed）**：已移除的功能
- **修复（Fixed）**：bug 修复
- **安全（Security）**：安全相关的修复

---

[未发布]: https://github.com/your-username/obsidian-cognitive-razor/compare/1.0.0...HEAD
[1.0.0]: https://github.com/your-username/obsidian-cognitive-razor/releases/tag/1.0.0
